### To do: rewrite this and comment code
